---
날짜: 2025-04-10
Objective: .env 파일을 통해 docker 환경변수를 동적으로 사용할수 있따.
Script: 
tags:
  - 🐲Project/개발활동/개인서버구축/Docker강의
---
OverVIew 
- 실행 환경이 많거나, 사용 해야 할 환경변수가 많을 시에는 환경변수를 정의하는 .env 파일을 통해 동적으로 환경변수를 사용한다.

Details 

# 환경변수 파일을 통한 환경변수 설정

```bash
jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ ll
total 68
drwxrwxr-x  4 jaebukbuk jaebukbuk  4096 Apr 21 13:28 ./
drwxr-x--- 13 jaebukbuk jaebukbuk  4096 Apr 21 13:28 ../
-rw-rw-r--  1 jaebukbuk jaebukbuk   152 Apr 21 12:58 Dockerfile
-rw-rw-r--  1 jaebukbuk jaebukbuk    64 Apr 21 13:23 .dockerignore
-rw-rw-r--  1 jaebukbuk jaebukbuk    33 Apr 21 13:25 .env.prod
-rw-rw-r--  1 jaebukbuk jaebukbuk    30 Apr 21 13:28 .evn.dev
drwxrwxr-x 70 jaebukbuk jaebukbuk  4096 Apr 21 10:43 node_modules/
-rw-rw-r--  1 jaebukbuk jaebukbuk   259 Apr 21 10:57 package.json
-rw-rw-r--  1 jaebukbuk jaebukbuk 29005 Apr 21 10:43 package-lock.json
drwxrwxr-x  2 jaebukbuk jaebukbuk  4096 Apr 21 13:03 src/
jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ cat .env.prod
PORT=9000
APP_NAME="MY PROD APP"
jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ cat .evn.dev
PORT=3000
APP_NAME=MY DEV APP
```

- 해당 Application 은 prod 환경과 dev 환경 두 환경에서 서로 다른 환경변수를 사용한다고 했을때 docker run 명령어를 통해 환경변수를 오버라이드 하기에는 번거로울수 있다.
- 이럴땐 각 환경에 맞는 .env 파일을 만들어 docker run 시에 해당 파일을 읽어 환경변수를 설정하도록 한다.

```bash
jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ docker run --env-file ".env.prod" -d -p 9000:9000 --name express-9000 express
34466ff6c74b5c312761e83dd8c6ef13d98ed4e143893b06f5929cc2ebf84fd5
jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ curl http://localhost:9000
hello from express "MY PROD APP"

jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ docker run --env-file ".evn.dev" -d -p 3000:3000 --name express-3000 express
5d84de80c8406aa3d7e71c42641c2c5b8651bc09fcdbf3f52d13a2472b4b5022
jaebukbuk@jaebukbukubuntu24:~/enviroment-variables$ curl http://localhost:3000
hello from express MY DEV APP 
```

- --env-file 과 "" 을 통해 환경변수 파일을 명시하여 같은 이미지를 에서 생성되는 컨테이너라도 다른 환경변수를 사용하여 실행시킬 수 있다.
