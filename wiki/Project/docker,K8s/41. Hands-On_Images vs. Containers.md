---
날짜: 2025-03-27
Objective: 이미지 VS 컨테이너
tags:
  - 🐲Project/개발활동/개인서버구축/Docker강의
---

OverVIew 

 - 이미지는 build 시점의 청사진이다.
   => 이미지를 재빌드 하든, 이미지를 구성하는 파일을 변경하든
   이미 빌드 된 이미지 이고, 해당 이미지를 기반으로 생성된 컨테이너에도 전혀 영향을 미치지 않는다. 

Details 

- Docker will start thst container with the contents of the image at the time of the container creation
- Images are the blueprint. containers are really created at a specific point in time with the code of the image, with the blueprint

# 이미지 재생성(Build) -> 컨터이너는?

```bash
jaebukbuk@jaebukbukubuntu24:~$ docker build -t web_server_image:first .
jaebukbuk@jaebukbukubuntu24:~$ docker images
REPOSITORY         TAG       IMAGE ID       CREATED         SIZE
web_server_image   first     9684ffc0f7a2   5 seconds ago   249MB

jaebukbuk@jaebukbukubuntu24:~$ docker run -d -p 3000:80 --name first  web_server_image:first

```
- 도커파일을 통해 이미지를 만들고, 파일수정후 똑같이 이미지를 만들본다

```bash
jaebukbuk@jaebukbukubuntu24:~$ vim testIndex.html
jaebukbuk@jaebukbukubuntu24:~$ docker build -t web_server_image:first .
jaebukbuk@jaebukbukubuntu24:~$ docker images
REPOSITORY         TAG       IMAGE ID       CREATED          SIZE
web_server_image   first     bf8e2cbe4f3e   7 minutes ago    249MB
<none>             <none>    9684ffc0f7a2   15 minutes ago   249MB

jaebukbuk@jaebukbukubuntu24:~$ docker ps

CONTAINER ID   IMAGE                      NAMES
4d1512d17dfe   9684ffc0f7a2              first
```

```bash
jaebukbuk@jaebukbukubuntu24:~$ curl http://localhost:3000
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<h1>first test index</>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```
- 이미지가 변했어도 컨테이너는 이전 버전의 이미지를 보고 있따.
```bash
jaebukbuk@jaebukbukubuntu24:~$ docker stop first
first
jaebukbuk@jaebukbukubuntu24:~$ docker start first
first
jaebukbuk@jaebukbukubuntu24:~$ curl http://localhost:3000
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
html { color-scheme: light dark; }
body { width: 35em; margin: 0 auto;
font-family: Tahoma, Verdana, Arial, sans-serif; }
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<h1>first test index</>

<p><em>Thank you for using nginx.</em></p>
</body>
</html>
```
- 심지어 컨테이너 스톱 이후, 다시 실행해도 기존 상태이다
```bash
jaebukbuk@jaebukbukubuntu24:~$ docker stop first
first
jaebukbuk@jaebukbukubuntu24:~$ docker rm first
first
aebukbuk@jaebukbukubuntu24:~$ docker run -d -p 3000:80 --name first  web_server_image:first

aebukbuk@jaebukbukubuntu24:~$ docker ps
CONTAINER ID   IMAGE                        NAME
4ddebf43e2af   web_server_image:first       first
```
- 도커 컨에이너를 rm 명령어로 삭제 이후에 다시 run해야 새로운 컨테이너로 생성된다!


# 파일을 수정했어도 이전 이미지랑은 상관없다.
```bash
jaebukbuk@jaebukbukubuntu24:~$ docker build -t web_server_image:second .
```
- 위에 파일 수정이후 second 버전으로 빌드한다.
```bash
jaebukbuk@jaebukbukubuntu24:~$ docker images
REPOSITORY         TAG       IMAGE ID       CREATED         SIZE
web_server_image   second    bf8e2cbe4f3e   7 seconds ago   249MB
web_server_image   first     9684ffc0f7a2   7 minutes ago   249MB
```
- 당연히 새로운 image_id 가 생성

```bash
jaebukbuk@jaebukbukubuntu24:~$ docker run -d -p 3003:80 --name fileChgYesBuild web_server_image:second
5eaa0d7425b7c5cba74a53dabfff61cbd6caf7ce676d5f55f7da7ac0618bcb3d
```
- 새로운 이미지로 컨테이너를 실행시킨다.

```bash

jaebukbuk@jaebukbukubuntu24:~$ curl http://localhost:3000
<!DOCTYPE html>
<html>
...
<h1>first test index</>
...
</html>

...

jaebukbuk@jaebukbukubuntu24:~$ curl http://localhost:3003
<!DOCTYPE html>
<html>
<head>
...
<h1>this is second  test index</>
...
</html>
```
- 파일이 변경되어도 이미 생성된 이미지를 기반하여 만들어진 컨터이너에는 영향을 미치지 않는다.